/**
 * Suggestions-jquery plugin, version 4.2.2
 *
 * Suggestions-jquery plugin is freely distributable under the terms of MIT-style license
 * Built on Ajax Autocomplete for jQuery (https://github.com/devbridge/jQuery-Autocomplete)
 * For details, see https://github.com/hflabs/suggestions-jquery
 */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";function b(c,d){var e=function(){},f=this,g={autoSelectFirst:!1,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:b.formatResult,delimiter:null,zIndex:9999,noCache:!1,onSearchStart:e,onSearchComplete:e,onSearchError:e,containerClass:"autocomplete-suggestions",tabDisabled:!1,currentRequest:null,triggerSelectOnValidInput:!1,triggerSelectOnSpace:!0,preventBadQueries:!0,lookupFilter:function(a,b,c){return-1!==a.value.toLowerCase().indexOf(c)},paramName:"query",transformResult:function(b){return"string"==typeof b?a.parseJSON(b):b}};f.element=c,f.el=a(c),f.suggestions=[],f.badQueries=[],f.selectedIndex=-1,f.currentValue=f.element.value,f.intervalId=0,f.cachedResponse={},f.onChangeInterval=null,f.onChange=null,f.isLocal=!1,f.suggestionsContainer=null,f.options=a.extend({},g,d),f.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},f.hint=null,f.hintValue="",f.selection=null,f.$viewport=a(window),f.triggeredSelectOnSpace=!1,f.skipOnFocus=!1,f.initialize(),f.setOptions(d)}var c=function(){return{escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(a){var b=document.createElement("div");return b.className=a,b.style.position="absolute",b.style.display="none",b}}}(),d={ESC:27,TAB:9,RETURN:13,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40},e=".suggestions",f="suggestions",g={};b.utils=c,a.Suggestions=b,b.formatResult=function(a,b){var d="(^|\\s+)("+c.escapeRegExChars(b)+")";return a.value.replace(new RegExp(d,"gi"),"$1<strong>$2</strong>")},b.prototype={killerFn:null,initialize:function(){var c,d=this,f="."+d.classes.suggestion,g=d.classes.selected,h=d.options;d.element.setAttribute("autocomplete","off"),d.killerFn=function(b){0===a(b.target).closest("."+d.options.containerClass).length&&(d.killSuggestions(),d.disableKillerFn())},d.suggestionsContainer=b.utils.createNode(h.containerClass),c=a(d.suggestionsContainer),c.appendTo(h.appendTo),"auto"!==h.width&&c.width(h.width),c.on("mouseover"+e,f,function(){d.activate(a(this).data("index"))}),c.on("mouseout"+e,function(){d.selectedIndex=-1,c.children("."+g).removeClass(g)}),c.on("click"+e,f,function(){d.select(a(this).data("index")),d.skipOnFocus=!0,d.el.focus()}),d.fixPosition(),d.fixPositionCapture=function(){d.visible&&d.fixPosition()},d.$viewport.on("resize"+e,d.fixPositionCapture),d.el.on("keydown"+e,function(a){d.onKeyPress(a)}),d.el.on("keyup"+e,function(a){d.onKeyUp(a)}),d.el.on("blur"+e,function(){d.onBlur()}),d.el.on("focus"+e,function(){d.onFocus()}),d.el.on("change"+e,function(a){d.onKeyUp(a)})},onFocus:function(){var a=this;a.skipOnFocus||(a.fixPosition(),a.options.minChars<=a.el.val().length&&a.onValueChange()),a.skipOnFocus=!1},onBlur:function(){this.enableKillerFn()},setOptions:function(b){var c=this,d=c.options;a.extend(d,b),c.isLocal=a.isArray(d.lookup),c.isLocal&&(d.lookup=c.verifySuggestionsFormat(d.lookup)),a(c.suggestionsContainer).css({"max-height":d.maxHeight+"px",width:d.width+"px","z-index":d.zIndex}),c.checkToken()},getAjaxParams:function(){var b,c=this,d=a.trim(c.options.token);return b={type:"POST",dataType:"json",contentType:"application/json"},d&&(b.headers={Authorization:"Token "+d}),b},checkToken:function(){var b,c=this,d=a.trim(c.options.token),e=g[d],f=function(){c.checkToken()};if(d)if(e&&a.isFunction(e.promise))switch(e.state()){case"resolved":c.enable();break;case"rejected":c.disable();break;default:e.then(f)}else b=c.options.serviceUrl,a.isFunction(b)&&(b=b.call(c.element)),g[d]=a.ajax(a.extend(c.getAjaxParams(),{url:b})).then(f)},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var a=this;a.disabled=!0,a.currentRequest&&a.currentRequest.abort()},enable:function(){this.disabled=!1},fixPosition:function(){var b,c,d,e=this,f=0;if("body"===e.options.appendTo){b=e.el.offset(),b.bottom=b.top+e.el.outerHeight();{e.$viewport.height()+e.$viewport.scrollTop()-b.bottom}d=a(e.suggestionsContainer),"content-box"===d.css("box-sizing")&&(f=parseFloat(d.css("border-top-width"))+parseFloat(d.css("border-bottom-width"))),c={top:b.bottom+"px",left:b.left+"px"},"auto"===e.options.width&&(c.width=e.el.outerWidth()-2+"px"),d.css(c)}},enableKillerFn:function(){var b=this;a(document).on("click"+e,b.killerFn)},disableKillerFn:function(){var b=this;a(document).off("click"+e,b.killerFn)},killSuggestions:function(){var a=this;a.stopKillSuggestions(),a.intervalId=window.setInterval(function(){a.hide(),a.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var a,b=this,c=b.el.val().length,d=b.element.selectionStart;return"number"==typeof d?d===c:document.selection?(a=document.selection.createRange(),a.moveStart("character",-c),c===a.text.length):!0},onKeyPress:function(a){var b,c,e=this;if(e.triggeredSelectOnSpace=!1,!e.disabled&&!e.visible&&a.which===d.DOWN&&e.currentValue)return void e.suggest();if(!e.disabled&&e.visible){switch(a.which){case d.ESC:e.el.val(e.currentValue),e.hide();break;case d.RIGHT:if(e.hint&&e.options.onHint&&e.isCursorAtEnd()){e.selectHint();break}return;case d.TAB:if(e.hint&&e.options.onHint)return void e.selectHint();if(-1===e.selectedIndex)return void e.hide();if(e.select(e.selectedIndex),e.options.tabDisabled===!1)return;break;case d.RETURN:if(b=e.selectedIndex,-1===b&&(c=e.getQuery(e.el.val()),b=e.findSuggestionIndex(c)),-1===b)return void e.hide();e.select(b);break;case d.SPACE:return void(e.options.triggerSelectOnSpace&&(b=e.selectedIndex,-1===b&&(c=e.getQuery(e.el.val()),b=e.findSuggestionIndex(c)),-1!==b&&(e.triggeredSelectOnSpace=!0,e.select(b,!0))));case d.UP:e.moveUp();break;case d.DOWN:e.moveDown();break;default:return}a.stopImmediatePropagation(),a.preventDefault()}},onKeyUp:function(a){var b=this;if(!b.disabled){switch(a.which){case d.UP:case d.DOWN:return}clearInterval(b.onChangeInterval),b.currentValue!==b.el.val()&&(b.findBestHint(),b.options.deferRequestBy>0?b.onChangeInterval=setInterval(function(){b.onValueChange()},b.options.deferRequestBy):b.onValueChange())}},onValueChange:function(){var b,c=this,d=c.options,e=c.el.val(),f=c.getQuery(e);return c.selection&&(c.selection=null,(d.onInvalidateSelection||a.noop).call(c.element)),clearInterval(c.onChangeInterval),c.currentValue=e,c.selectedIndex=-1,d.triggerSelectOnValidInput&&(b=c.findSuggestionIndex(f),-1!==b)?void c.select(b):void(f.length<d.minChars?c.hide():c.getSuggestions(f))},findSuggestionIndex:function(b){var c=this,d=-1,e=b.toLowerCase();return a.each(c.suggestions,function(a,b){return b.value.toLowerCase()===e?(d=a,!1):void 0}),d},getQuery:function(b){var c,d=this.options.delimiter;return d?(c=b.split(d),a.trim(c[c.length-1])):b},getSuggestionsLocal:function(b){var c,d=this,e=d.options,f=b.toLowerCase(),g=e.lookupFilter,h=parseInt(e.lookupLimit,10);return c={suggestions:a.grep(e.lookup,function(a){return g(a,b,f)})},h&&c.suggestions.length>h&&(c.suggestions=c.suggestions.slice(0,h)),c},getSuggestions:function(b){var c,d,e,f=this,g=f.options,h=g.serviceUrl;if(g.params[g.paramName]=b,d=g.ignoreParams?null:g.params,f.isLocal?c=f.getSuggestionsLocal(b):(a.isFunction(h)&&(h=h.call(f.element,b)),e=h+"?"+a.param(d||{}),c=f.cachedResponse[e]),c&&a.isArray(c.suggestions))f.suggestions=c.suggestions,f.suggest();else if(!f.isBadQuery(b)){if(g.onSearchStart.call(f.element,g.params)===!1)return;f.currentRequest&&f.currentRequest.abort(),f.currentRequest=a.ajax(a.extend(f.getAjaxParams(),{url:h,data:JSON.stringify(d)})).done(function(a){var c;f.currentRequest=null,c=g.transformResult(a),f.processResponse(c,b,e),g.onSearchComplete.call(f.element,b,c.suggestions)}).fail(function(a,c,d){g.onSearchError.call(f.element,b,a,c,d)})}},isBadQuery:function(a){if(!this.options.preventBadQueries)return!1;for(var b=this.badQueries,c=b.length;c--;)if(0===a.indexOf(b[c]))return!0;return!1},hide:function(){var b=this;b.visible=!1,b.selectedIndex=-1,a(b.suggestionsContainer).hide(),b.signalHint(null)},suggest:function(){if(0===this.suggestions.length)return void this.hide();var b,c,d=this,e=d.options,f=e.formatResult,g=d.getQuery(d.currentValue),h=d.classes.suggestion,i=d.classes.selected,j=a(d.suggestionsContainer),k=e.beforeRender,l="";return e.triggerSelectOnValidInput&&(b=d.findSuggestionIndex(g),-1!==b)?void d.select(b):(e.triggerSelectOnSpace&&!d.triggeredSelectOnSpace&&/\s$/.test(g)&&(b=d.findSuggestionIndex(g.replace(/\s$/,"")),-1!==b&&d.onSelect(b)),a.each(d.suggestions,function(a,b){l+='<div class="'+h+'" data-index="'+a+'">'+f(b,g)+"</div>"}),"auto"===e.width&&(c=d.el.outerWidth()-2,j.width(c>0?c:300)),j.html(l),e.autoSelectFirst&&(d.selectedIndex=0,j.children().first().addClass(i)),a.isFunction(k)&&k.call(d.element,j),j.show(),d.visible=!0,void d.findBestHint())},findBestHint:function(){var b=this,c=b.el.val().toLowerCase(),d=null;c&&(a.each(b.suggestions,function(a,b){var e=0===b.value.toLowerCase().indexOf(c);return e&&(d=b),!e}),b.signalHint(d))},signalHint:function(b){var c="",d=this;b&&(c=d.currentValue+b.value.substr(d.currentValue.length)),d.hintValue!==c&&(d.hintValue=c,d.hint=b,(this.options.onHint||a.noop)(c))},verifySuggestionsFormat:function(b){return b.length&&"string"==typeof b[0]?a.map(b,function(a){return{value:a,data:null}}):b},processResponse:function(a,b,c){var d=this,e=d.options;a.suggestions=d.verifySuggestionsFormat(a.suggestions),e.noCache||(d.cachedResponse[c]=a,e.preventBadQueries&&0===a.suggestions.length&&d.badQueries.push(b)),b===d.getQuery(d.currentValue)&&(d.suggestions=a.suggestions,d.suggest())},activate:function(b){var c,d=this,e=d.classes.selected,f=a(d.suggestionsContainer),g=f.children();return f.children("."+e).removeClass(e),d.selectedIndex=b,-1!==d.selectedIndex&&g.length>d.selectedIndex?(c=g.get(d.selectedIndex),a(c).addClass(e),c):null},selectHint:function(){var b=this,c=a.inArray(b.hint,b.suggestions);b.select(c)},select:function(a,b){var c=this,d=c.suggestions[a];c.currentValue=c.getValue(d.value),c.el.val(c.currentValue),c.signalHint(null),c.selection=d,b||c.hide(),c.onSelect(a),c.suggestions=[]},unselect:function(){var b=this;a(b.suggestionsContainer).children().removeClass(b.classes.selected),b.selectedIndex=-1,b.el.val(b.currentValue),b.findBestHint()},moveUp:function(){var a=this;return-1===a.selectedIndex?void(a.suggestions.length&&a.adjustScroll(a.suggestions.length-1)):0===a.selectedIndex?void a.unselect():void a.adjustScroll(a.selectedIndex-1)},moveDown:function(){var a=this;return a.selectedIndex===a.suggestions.length-1?void a.unselect():void a.adjustScroll(a.selectedIndex+1)},adjustScroll:function(b){var c,d,e,f=this,g=f.activate(b),h=25;g&&(c=g.offsetTop,d=a(f.suggestionsContainer).scrollTop(),e=d+f.options.maxHeight-h,d>c?a(f.suggestionsContainer).scrollTop(c):c>e&&a(f.suggestionsContainer).scrollTop(c-f.options.maxHeight+h),f.el.val(f.getValue(f.suggestions[b].value)),f.signalHint(null))},onSelect:function(b){var c=this,d=c.options.onSelect,e=c.suggestions[b];a.isFunction(d)&&d.call(c.element,e)},getValue:function(a){var b,c,d=this,e=d.options.delimiter;return e?(b=d.currentValue,c=b.split(e),1===c.length?a:b.substr(0,b.length-c[c.length-1].length)+a):a},dispose:function(){var b=this;b.el.off(e).removeData(f),b.disableKillerFn(),b.$viewport.off("resize"+e),a(b.suggestionsContainer).remove()}},a.fn.suggestions=function(c,d){return 0===arguments.length?this.first().data(f):this.each(function(){var e=a(this),g=e.data(f);"string"==typeof c?g&&"function"==typeof g[c]&&g[c](d):(g&&g.dispose&&g.dispose(),g=new b(this,c),e.data(f,g))})}});